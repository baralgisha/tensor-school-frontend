# Копирование объектов и ссылки

Одним из фундаментальных отличий объектов от примитивов является то, что они хранятся и копируются **«по ссылке»**.

Примитивные типы: строки, числа, логические значения – присваиваются и копируются **«по значению»**.

Если записать переменную с примитивом в другую, будут две независисые переменные.

```JavaScript
   let message = 'Привет';
   let greeting = message;
```

А если попробовать провернуть данный трюк с объектом, этого не произойдет.

```JavaScript
   const user = {
      name: 'Имя не указано'
   };

   const employee1 = user;
   employee.name = 'Петр';

   const employee2 = user;
   employee.name = 'Иван';

   // Выведет 'Иван'
   console.log(employee1.name);
   
   // ... тоже 'Иван' 
   console.log(employee2.name);

   // ... все так же 'Иван' =)
   console.log(user.name);
```

Это происходит из-за того, что при попытке записать в переменную объект копируется не сам объет, а ссылка на него.

Если мы представляем объект как ящик, то переменная – это ключ к нему. Копирование переменной дублирует ключ, но не сам ящик.

Для доступа к объекту в примере выше, можно использовать как переменную `user`, так и `employee`.

```JavaScript
   // ...
   
   console.log(user === employee); // true
```

> ***Когда переменная объекта копируется – копируется ссылка, сам же объект не дублируется.***

А что делать, если все-таки нужно скопировать объект, т.е создать его копию (клон)?

Для этого существуют несколько способов, например,

**`Object.assign(dest, [src1, src2, src3...])`**,

где `dest` - целевой объект, а аргументы `src1, src2, src3...` - объекты, которые мы хотим в него скопировать.

Метод копирует свойства всех исходных объектов `src1, ..., srcN` в целевой объект `dest` и возвращает измененный `dest`.

Т.е. для клонирования объекта `user` можно воспользоваться следующей конструкцией:

```JavaScript
   const user = {
      name: 'Иван'
   };

   const employee = Object.assign({}, user);
   employee.name = 'Петр';

   // Выведет 'Петр'
   console.log(employee.name);
   
   // Выведет 'Иван'
   console.log(user.name);

   // false
   console.log(user === employee);
```

>Необходимо помнить, что Object.assign не делает глубокое клонирование объекта. Если внутри копируемого объекта есть свойство, значение которого не является примитивом, оно будет передано по ссылке. 

Также для клонирования и копирования объектов можно воспользоваться `spread` оператором.

```JavaScript
   const user = {
      name: 'Иван'
   };

   const employee = {...user};
```

Синтаксис очень похож на Object.assign.

**`{dest, ...src1, ...src2, ...srcN}`**.

Этот подход копирует свойства всех исходных объектов `src1, ..., srcN` в целевой объект `dest` и возвращает новый объект.

Подробнее можно почитать тут:  
<https://learn.javascript.ru/object-copy>