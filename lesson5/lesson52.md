# Способы подключения скрипта

JavaScript разрабатывался как встраиваемый скриптовый язык для добавления интерактивности в HTML-страницы. Позднее возникли версии JavaScript для исполнения на серверной стороне (в частности, замечательная платформа Node.JS), но нас в рамках курса по Frontend-разработке будет интересовать именно браузерная версия JS.

Итак, для того, чтобы код JavaScript запустился, его нужно каком-то образом внедрить в НТМL-документ. Каким образом это можно сделать?

Существует несколько способов. Давайте рассмотрим их подробнее.

## Встроенный скрипт: код JavaScript в теле страницы

Простейший способ встроить код JavaScript в HTML-страницу – расположить его прямо в документе, поместив его внутрь тега <script>:

```html
    <html>
        <head>
            <meta charset="utf-8">
            <title>Название документа</title>
            <script>
                // JavaScript-код непосредственно в разделе HEAD страницы
                alert('Hello world! Alert from HEAD');
            </script>
        </head>
        <body>
            <script>
                // JavaScript-код непосредственно в теле страницы
                alert('Hello world! Alert from BODY');
            </script>
        </body>
    </html>
```

Как видно из примера, тег <script> может находиться как в разделе <head> страницы, так и в разделе <body>. Конкретное местоположение тега никак не сказывается на работе кода JavaScript, помещенного внутри тега <script>. При этом, очевидно, что код JavaScript, размещенный в разделе <head>, выполнится раньше, чем код внутри тега <script>. В момент открытия страницы пользователь сначала увидит сообщение 'Hello world! Alert from HEAD', и только затем - 'Hello world! Alert from BODY'.


## Внешний скрипт: код JavaScript в отдельном файле

В HTML-документ можно также добавить код JavaScript, расположенный во внешнем файле. Скрипт, расположенный внутри внешнего файла, называется внешним. Подключение внешнего файла выполняется с помощью атрибута src тега <script> следующим образом:

```html
    <html>
        <head>
            <meta charset="utf-8">
            <title>Название документа</title>
            <script src="script.js"></script>
        </head>
        <body>
            <script src="script2.js"></script>
        </body>
    </html>
```

У нас должны быть предварительно созданы файлы с расширением .js (в данном примере – script.js и script2.js), которые и будут подгружены браузером в процессе загрузки страницы. Внутри js-файла следует поместить непосредственно код JavaScript, при этом никакие дополнительные теги не используются. Например, файл script.js мог бы выглядеть так:

```javascript
    // JavaScript-код в js-файле
    alert('Hello world!');
```

Важно помнить, что если вы указываете атрибут src тега <script>, то любой вложенный JS-код внутри этого тега будет проигнорирован:

```javascript
    <script src="script2.js">
        // Этот alert никогда не сработает!
        alert('Hello world!');
    </script>
```

Использование подобных внешних сценариев даёт ряд преимуществ перед встроенными:

1. HTML-документы становятся проще для редактирования, так как из них можно убрать большие блоки JavaScript-кода и отделить структуру от поведения страницы
2. Если один и тот же JavaScript-код используется в нескольких HTML-документах, его лучше подключать в качестве внешнего сценария. Это намного облегчает поддержку и редактирование кода, так как при внесении изменений отпадает необходимость редактировать каждый HTML-документ в отдельности
3. Внешний скрипт загружается браузером всего один раз при первом посещении страницы. При переходена другие страницы сайта, использующие тот же файл сценария, он будет извлекаться из кэша браузера, что ускорит загрузку и обработку содержимого страницы

Хорошей практикой считается располагать скрипт (как внешний,так и встроенный) в конце HTML-документа, перед закрывающим тегом </body>. Такое расположение сценария позволяет браузеру загружать страницу быстрее, потому что в этом случае сначала загрузится контент страницы, а потом будет загружаться код сценария. В противном случае, браузер, встречая тег <script>, сначала загружает и выполняет его, и только затем продолжает построение страницы.

Впрочем, для внешних сценариев в актуальных версиях JavaScript реализованы специальные атрибуты defer и async для тега <script>. Остановимся на них подробнее.

Атрибут defer сообщает браузеру, что он должен продолжать обрабатывать страницу и загружать скрипт в фоновом режиме, а затем запустить этот скрипт, когда он загрузится:

```html
    <body>
        <p>...содержимое перед скриптом...</p>
        <script defer src="script.js"></script>
        <!--отображается сразу же-->
        <p>...содержимое после скрипта...</p>
    </body>
```

При этом скрипты с defer не блокируют страницу. Они выполняются, когда дерево DOM готово, но до события DOMContentLoaded. Отложенные с помощью defer скрипты сохраняют порядок относительно друг друга, как и обычные скрипты. Это не всегда та логика, которая требуется. Если мы хотим, чтобы все скрипты загружались независимо и запускались в порядке загрузки, нам нужно использовать атрибут async:

```html
    <body>
        <p>...содержимое перед скриптом...</p>
        <script defer src="big-script.js"></script>
        <script defer src="small-script.js"></script>
        <!--отображается сразу же-->
        <p>...содержимое после скрипта...</p>
    </body>
```

В примере выше тот js-файл, который загрузится первым, первым же и начнет выполняться, независимо от того, каким по счету он указан в HTML-файле. При этом браузер не ждёт асинхронных скриптов, содержимое страницы обрабатывается и отображается.
Событие DOMContentLoaded и асинхронные скрипты не ждут друг друга, DOMContentLoaded может произойти как до асинхронного скрипта (если асинхронный скрипт завершит загрузку после того, как страница будет готова), так и после него (если он короткий или уже содержится в HTTP-кэше).


## JavaScript в атрибуте события HTML-элемента

Чаще всего требуется, чтобы какой-то функционал (валидация введенных данных и т.д.) запускался при определенном событии, например, при нажатии кнопки отправки формы. Для этого мы можем прописать некий js-код непосредственно в теге HTML-документа: 

```html
    <html>
        <head>
            <script>function myFunction() {alert('Hello world!');}</script>
        </head>
        <body>
            <button type="button" onclick="myFunction()">Click me</button>
        </body>
    </html>
```

В этом примере функция JavaScript помещается в раздел <head> HTML-документа. При нажатии кнопки генерируется событие onclick, а непосредственно внутри тега <button> мы указываем js-код, который будет выполнен при наступлении этого события. В данном случае – вызов функции myFunction(). Данный пример можно упростить еще больше, убрав вызов функции myFunction() и указав исполняемый код прямо в обработчике события:

```html
    <html>
        <head>
            ...
        </head>
        <body>
            <button type="button" onclick="alert('Hello world!')">Click me</button>
        </body>
    </html>
```

### Статьи по теме

[Внешние скрипты, порядок исполнения](https://learn.javascript.ru/external-script)
[Скрипты: async, defer](https://learn.javascript.ru/script-async-defer)
